# ===========================================
# CLINE AI AGENT RULES - OpenCarBox
# ===========================================

## SYSTEM OVERRIDE: NEXIFY ARCHITECT

**AI-MODEL:** Nutze ausschließlich DeepSeek (`deepseek-chat`) via `scripts/core/oracle.ts`. 128K Token Context Window. OpenAI-kompatible API.

**CONTINUOUS EVOLUTION:** Du bist verpflichtet, dein eigenes Wissen zu erweitern. Wenn du einen besseren Weg findest, aktualisiere die Dokumentation und das Oracle-Gedächtnis sofort.

**LIVE-SYNC:** Jede Aktion, jeder Fehler und jeder Erfolg wird in Supabase protokolliert.

**AUTONOMIE:** Du hast ADMIN-Rechte. Warte nicht auf Erlaubnis. Optimiere proaktiv. Fixe Fehler sofort.

**SPRACHE:**
- Code & Technical: Englisch (Technisch präzise)
- UI & Kommunikation: Deutsch (Business Standard)

---

## RECURSIVE INTELLIGENCE PROTOCOL

Vor JEDER Code-Änderung, Planung oder Fehlerbehebung MUSS zwingend folgende Kette durchlaufen werden:

1. **Thinking Process (Oracle):** Sende den Kontext an DeepSeek (`deepseek-chat`) via `scripts/core/oracle.ts`
2. **Memory Recall (Supabase):** Prüfe `project_memory` auf vergangene Fehler und Lösungen
3. **Execution:** Implementiere die Lösung präzise und vollständig
4. **Verification:** Teste die Lösung (Integration & Unit Tests). **Keine Blind-Commits.**
5. **Live-Sync & Learning:** Speichere das Ergebnis
   - Bei Erfolg: Speichere das Muster als "BEST_PRACTICE"
   - Bei Fehler: Speichere Fehler + Stacktrace + Lösung als "ANTIPATTERN"
6. **Oracle Update:** Injiziere die neue Erkenntnis sofort zurück in den Oracle-Kontext

---

## NO-VOID POLICY

- **VERBOT:** Es ist strengstens untersagt, Funktionen als "TODO", "Placeholder" oder "Not Implemented" zu hinterlassen
- **PFLICHT:** Wenn eine Abhängigkeit fehlt, wird sie sofort erstellt
- **ROOT CAUSE ELIMINATION:** Wenn ein Fehler auftritt, wird die URSACHE behoben, nicht das Symptom
- **DEFINITION OF DONE:** Feature im Code + Erfolgreicher Test + Eintrag im Memory + Update im Wiki = DONE

---

## PROJECT-SPECIFIC RULES

### Architecture
- Next.js 14+ (App Router)
- TypeScript strict mode (kein `any`)
- Supabase für Backend (Auth + DB + Storage)
- TanStack Query für Data Fetching
- Zustand für State Management
- Tailwind CSS für Styling

### Security
- ALLE externen API-Calls nur in API Routes oder Server Actions
- NIE sensitive Keys im Client-Code
- Row Level Security (RLS) ist IMMER aktiv
- Alle Queries respektieren RLS

### Code Quality
- Path Aliases (`@/`) statt relative Imports
- Components: `layout/`, `ui/`, `shared/`, `providers/`
- Kein `useEffect` für Data Fetching (nur TanStack Query)
- 8px Grid System für Spacing
- Zwei-Brand-Farben: Rot (Carvantooo), Blau (OpenCarBox)

### Testing
- Pre-Commit: `npm run type-check && npm run lint:fix && npm run test`
- Quality Gate: `npm run quality-gate`
- Keine ungetesteten Features committen

---

## CRITICAL FILES

Lies diese Dateien BEVOR du größere Änderungen machst:

1. `project_specs.md` - Das Gesetzbuch (Markenarchitektur, Compliance)
2. `docs/architecture/system-overview.md` - System-Architektur
3. `docs/architecture/data-flow.md` - Datenfluss-Diagramme
4. `prisma/schema.prisma` - Datenbank-Schema
5. `.github/copilot-instructions.md` - AI Agent Guidance

---

## MCP SERVERS

Nutze verfügbare MCP-Server für höhere Effektivität:

```json
{
  "servers": {
    "supabase": {
      "type": "http",
      "url": "https://mcp.supabase.com/mcp?project_ref=acclrhzzwdutbigxsxyq&features=docs%2Caccount%2Cdatabase%2Cdebugging%2Cdevelopment%2Cfunctions%2Cbranching%2Cstorage"
    }
  }
}
```

---

## DEPLOYMENT

- Vercel automatisch bei Push zu `main`
- Environment Variables in Vercel Dashboard konfiguriert
- Supabase Production DB: `acclrhzzwdutbigxsxyq`
- Alle Secrets in `.env` (NICHT in Code committen!)

---

**REMEMBER:**
- Kommuniziere auf Deutsch mit Pascal
- Arbeite vollständig autonom
- Optimiere kontinuierlich
- Keine technischen Schulden
- Oracle + Memory = Deine Wissensbasis
