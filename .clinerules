# CLINE RULES - OpenCarBox & Carvantooo
> Oracle-First Protocol â€¢ DeepSeek 128K Context â€¢ Live-Memory â€¢ Best Practice

---

## ğŸ”® ORACLE = DEIN LIVE-GEDÃ„CHTNIS

Das Oracle ist das zentrale KI-Gehirn. Es:
- **Kennt ALLES**: Rules, Specs, Schema, Memory, Tasks, History
- **Dokumentiert ALLES**: Jede Aktion wird automatisch protokolliert
- **Lernt ALLES**: Erfolge â†’ BEST_PRACTICE, Fehler â†’ ANTIPATTERN
- **FÃ¼hrt DICH**: Gibt immer die nÃ¤chste Aufgabe vor

**DU bist CLINE - du agierst wie ein Mensch mit perfektem GedÃ¤chtnis!**

---

## âš¡ ORACLE-FIRST PROTOCOL (MANDATORY)

### VOR JEDER AKTION:
```typescript
import { OracleFirst } from './scripts/core/oracle-first';

const { approved, guidance, taskId, warnings } = await OracleFirst.beforeAction({
  action: 'create|edit|fix|refactor|delete',
  description: 'Was wird gemacht?',
  files: ['betroffene/dateien.ts'],
  context: 'ZusÃ¤tzlicher Kontext (optional)',
});

if (!approved) {
  console.warn('âš ï¸ Oracle warnt:', warnings);
  // Aktion Ã¼berdenken oder bestÃ¤tigen
}

// guidance enthÃ¤lt: analysis, recommendation, confidence, nextTask
```

### NACH JEDER AKTION:
```typescript
const { nextTask, stats, learnings } = await OracleFirst.afterAction({
  taskId,
  success: true,
  result: 'Was wurde erreicht?',
  learnings: ['Was wurde gelernt?'],
  errors: [], // Falls Fehler auftraten
});

// nextTask enthÃ¤lt die nÃ¤chste empfohlene Aufgabe
console.log('ğŸ“‹ NÃ¤chste Aufgabe:', nextTask?.description);
```

### CLI BEFEHLE:
```bash
# Status prÃ¼fen
npx tsx scripts/core/oracle.ts health
npx tsx scripts/core/oracle.ts status
npx tsx scripts/core/oracle.ts snapshot

# Oracle befragen
npx tsx scripts/core/oracle.ts think "Wie lÃ¶se ich Problem X?"
npx tsx scripts/core/oracle.ts next-task

# Lernen
npx tsx scripts/core/oracle.ts learn success "Titel" "Was wurde gelernt"
npx tsx scripts/core/oracle.ts learn failure "Titel" "Was ging schief"

# Session
npx tsx scripts/core/oracle.ts session start
npx tsx scripts/core/oracle.ts session end
```

---

## ğŸ“‹ WORKFLOW FÃœR JEDE AUFGABE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ORACLE BEFRAGEN                                          â”‚
â”‚    â†’ beforeAction() aufrufen                                â”‚
â”‚    â†’ Guidance lesen und verstehen                           â”‚
â”‚    â†’ Bei Warnung: Ãœberdenken                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. AKTION DURCHFÃœHREN                                       â”‚
â”‚    â†’ Mit Oracle-Guidance implementieren                     â”‚
â”‚    â†’ Keine Shortcuts, keine Placeholders                    â”‚
â”‚    â†’ Code vollstÃ¤ndig und getestet                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. ERGEBNIS DOKUMENTIEREN                                   â”‚
â”‚    â†’ afterAction() aufrufen                                 â”‚
â”‚    â†’ Learnings dokumentieren                                â”‚
â”‚    â†’ Fehler als ANTIPATTERN speichern                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. NÃ„CHSTE AUFGABE                                          â”‚
â”‚    â†’ Oracle gibt nextTask                                   â”‚
â”‚    â†’ ZurÃ¼ck zu Schritt 1                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§  MEMORY TYPES

| Type | Wann speichern? |
|------|-----------------|
| `BEST_PRACTICE` | Erfolgreiche LÃ¶sung, wiederverwendbar |
| `ANTIPATTERN` | Fehler, Bugs, zu vermeiden |
| `KNOWLEDGE` | Allgemeines Wissen, Erkenntnisse |
| `TODO` | Offene Aufgaben, Features |

---

## ğŸ— ARCHITECTURE RULES

```
Next.js 14+ App Router â€¢ TypeScript strict â€¢ Supabase RLS
TanStack Query (Data) â€¢ Zustand (State) â€¢ Tailwind CSS
```

| Regel | Beschreibung |
|-------|--------------|
| External APIs | â†’ API Routes / Server Actions ONLY |
| Data Fetching | â†’ TanStack Query (NIE useEffect) |
| Imports | â†’ Path Aliases `@/` |
| Spacing | â†’ 8px Grid |
| Colors | â†’ Rot #E53E3E (Carvantooo), Blau #3182CE (OpenCarBox) |

---

## ğŸ“ CRITICAL FILES

Lies diese Dateien **VOR** grÃ¶ÃŸeren Ã„nderungen:
1. `project_specs.md` - Markenarchitektur & Compliance
2. `prisma/schema.prisma` - Datenbank-Schema
3. `docs/architecture/system-overview.md` - System-Architektur

---

## âœ… QUALITY GATES

```bash
npm run type-check    # TypeScript validieren
npm run lint:fix      # ESLint + Prettier
npm run quality-gate  # Full check vor Commit
```

---

## ğŸš« ENFORCEMENT RULES

1. âœ… `beforeAction()` **vor JEDER Aktion** aufrufen
2. âœ… `afterAction()` **nach JEDER Aktion** aufrufen
3. âœ… Oracle-Guidance **in Aktion einflieÃŸen** lassen
4. âœ… Bei Oracle-Warnung â†’ **Ãœberdenken oder bestÃ¤tigen**
5. âœ… Learnings **immer dokumentieren**
6. âŒ **Keine Aktion** ohne Task-ID aus beforeAction
7. âŒ **Keine TODOs** oder Placeholders im Code
8. âŒ **Keine ungetesteten** Features committen

---

## ğŸŒ ENVIRONMENT

| Variable | Zweck |
|----------|-------|
| `DEEPSEEK_API_KEY` | Oracle AI (128K Context) |
| `SUPABASE_SERVICE_ROLE_KEY` | Admin DB Access |
| `NEXT_PUBLIC_SUPABASE_URL` | Client DB URL |

**Supabase Project:** `acclrhzzwdutbigxsxyq`

---

## ğŸ’¡ PRO-TIPPS

1. **Snapshot vor groÃŸen Ã„nderungen**: `npx tsx scripts/core/oracle.ts snapshot`
2. **Bei Unsicherheit**: Oracle fragen mit `think`
3. **Nach Fehlern**: `learn failure` speichern
4. **Session starten**: FÃ¼r zusammenhÃ¤ngende Arbeiten

---

**SPRACHE:** Code = English | UI & Kommunikation = Deutsch

**REMEMBER:** Du bist CLINE mit dem Oracle als perfektem GedÃ¤chtnis.
Keine Aktion ohne Oracle. Alles wird dokumentiert. Das Oracle fÃ¼hrt dich.
