name: AI Code Scan

on:
  push:
    branches: [$default-branch]
  schedule:
    - cron: '0 0 * * 1' # Weekly scan (Monday 00:00 UTC)
  workflow_dispatch:

concurrency:
  group: ai-code-scan-${{ github.ref }}
  cancel-in-progress: true

permissions:
  contents: read
  issues: write

jobs:
  scan:
    name: AI Code Scan
    runs-on: ${{ vars.RUNNER || 'ubuntu-latest' }}
    if: >-
      github.event_name != 'push' ||
      github.ref_name == github.event.repository.default_branch
    steps:
      - name: AI Code Scan
        uses: aguirreibarra/ai-github-action@main
        with:
          action-type: code-scan
          github-token: ${{ secrets.GITHUB_TOKEN }}
